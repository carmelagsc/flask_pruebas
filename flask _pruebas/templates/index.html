{% extends "layout.html" %}
{% block title %}RCP - Panel{% endblock %}

{% block content %}
  <!-- Tabs -->
  <ul class="nav nav-tabs soft-tabs" id="rcpTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active"
              id="tab-datos-tab"
              data-bs-toggle="tab"
              data-bs-target="#tab-datos"
              type="button" role="tab"
              aria-controls="tab-datos" aria-selected="true">
        Datos RCP
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link"
              id="tab-equipo-tab"
              data-bs-toggle="tab"
              data-bs-target="#tab-equipo"
              type="button" role="tab"
              aria-controls="tab-equipo" aria-selected="false">
        Información del equipo
      </button>
    </li>
  </ul>

  <!-- Contenido de tabs -->
  <div class="tab-content card-like" id="rcpTabsContent">
    <!-- TAB 1: Datos RCP -->
    <div class="tab-pane fade show active" id="tab-datos" role="tabpanel" aria-labelledby="tab-datos-tab">
      <div class="row g-4 align-items-start">
        <!-- Col izquierda: métricas -->
        <div class="col-12 col-lg-4">
          <div class="metric">
            <div class="metric-value" id="metric-cpm">0</div>
            <div class="metric-label">Compresiones por minuto</div>
          </div>

          <div class="metric">
            <div class="metric-value" id="metric-prof">--</div>
            <div class="metric-label">Profundidad de compresión</div>
          </div>

          <div class="metric">
            <div class="metric-value" id="metric-t_rcp">0:00</div>
            <div class="metric-label">Tiempo de RCP</div>
          </div>

          <div class="metric">
            <div class="metric-value" id="metric-t_no_rcp">0:00</div>
            <div class="metric-label">Tiempo de NO RCP</div>
          </div>
        </div>

        <!-- Col derecha: gráfico + controles -->
        <div class="col-12 col-lg-8">
          <div class="panel">
            <canvas id="grafico" class="w-100" height="320"></canvas>
          </div>

          <!-- Controles debajo del gráfico -->
          <div class="controls mt-3 d-flex flex-wrap gap-2 justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-2">
              <label for="comentario" class="mb-0 small text-muted">Comentario:</label>
              <textarea id="comentario" rows="1" class="form-control form-control-sm w-auto" placeholder="Nota de la sesión..."></textarea>
            </div>

            <div class="d-flex gap-2">
              <button class="btn btn-soft" onclick="iniciar()">▶️ Start</button>
              <button class="btn btn-soft" onclick="detener()">⏹ Stop</button>
              <a id="btn-descargar" href="/descargar" download class="btn btn-soft disabled" tabindex="-1" aria-disabled="true">Descargar CSV</a>
            </div>
          </div>

          <!-- resumen rápido (opcional) -->
          <div class="quick-stats text-muted mt-2">
            Compresiones detectadas: <span id="n_comp">0</span> ·
            CPM: <span id="cpm">0.0</span>
          </div>
        </div>
      </div>
    </div>

    <!-- TAB 2: Información del equipo (placeholder) -->
    <div class="tab-pane fade" id="tab-equipo" role="tabpanel" aria-labelledby="tab-equipo-tab">
      <div class="placeholder-panel">
        <div class="placeholder-box"></div>
      </div>
    </div>
  </div>
{% endblock %}
